webpackJsonp([8],{OeSr:function(e,t){},otcZ:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=l("bOdI"),a=l.n(i),o=l("lHA8"),r=l.n(o),s=l("XLwt"),n={methods:{initData:function(){var e=this,t={page:this.currentPage,pageSize:this.defalut_pageSize};this.$store.dispatch("sysd/getAllStation",t).then(function(t){t.obj.list;e.tableData=t.obj.list,e.totalPage=t.obj.total})},handleSizeChange:function(e){var t=this;console.log("每页 "+e+" 条"),this.defalut_pageSize=e;var l={page:this.currentPage,pageSize:this.defalut_pageSize};this.$store.dispatch("sysd/getAllStation",l).then(function(e){t.tableData=e.obj.list,t.totalPage=e.obj.total})},handleCurrentChange:function(e){var t=this;console.log("当前页: "+e),this.currentPage=e;var l={page:this.currentPage,pageSize:this.defalut_pageSize};this.$store.dispatch("sysd/getAllStation",l).then(function(e){t.tableData=e.obj.list,t.totalPage=e.obj.total})},open:function(){var e=this;this.$store.dispatch("sysd/getAllUser").then(function(t){e.users=t.obj;var l={page:1,pageSize:1e4};e.$store.dispatch("sysd/getAllDistrict",l).then(function(t){e.districts=t.obj.list}),e.$store.dispatch("sysd/getAllStation",l).then(function(t){for(var l=[],i=t.obj.list,a=0;a<i.length;a++)l.push({stationId:i[a].id,stationName:i[a].name});e.stations=l})})},add:function(){var e=this;this.$store.dispatch("sysd/addStation",this.form).then(function(t){200==t.status&&(e.$message({message:t.msg,type:"success"}),e.reload())})},showBasin:function(e){this.dialogFormVisible3=!0,this.station_title=e.name,this.$store.dispatch("sysd/getRelBySid",e.id).then(function(e){for(var t,l=e.obj,i=new r.a,o=[],n=0;n<l.length;n++){var d=l[n].split("@");i.add(d[0]),i.add(d[2]);var c={source:d[0],target:d[2],name:d[1]};console.log(c),o.push(c)}var m=[];i.forEach(function(e,t){var l={name:e,symbolSize:50,itemStyle:{normal:{show:!0}}};m.push(l)});var u={tooltip:{formatter:function(e){return e.data.name}},animationDurationUpdate:1500,animationEasingUpdate:"quinticInOut",series:[(t={type:"graph",layout:"force",symbolSize:80,roam:!0,label:{normal:{show:!0,color:"black"}},edgeSymbol:["circle","arrow"],edgeSymbolSize:[4,10],edgeLabel:{normal:{textStyle:{fontSize:20}}},force:{repulsion:3e3,edgeLength:[20,80]},draggable:!0,lineStyle:{normal:{width:2,color:"black",curveness:.2,length:20}}},a()(t,"edgeLabel",{normal:{show:!0,formatter:function(e){return e.data.name}}}),a()(t,"data",m),a()(t,"links",o),t)]};s.init(document.getElementById("chartArea")).setOption(u)})},showModifyWindow:function(e){this.dialogFormVisible2=!0,this.form1.id=e.id,this.form1.name=e.name,this.form1.longtitude=e.longtitude,this.form1.latitude=e.latitude,this.form1.currLevel=e.currlevel,this.form1.preLevel=e.prelevel,this.form1.user=e.userinfo.uid,this.form1.district=e.district.id,this.form1.province=e.province.id,this.form1.isAlert=e.isAlert},modify:function(){var e=this;this.$store.dispatch("sysd/modifyStation",this.form1).then(function(t){200==t.status&&(e.$message({message:t.msg,type:"success"}),e.reload())})},showDeleteWindow:function(e){this.stationId=e.id,this.centerDialogVisible=!0},deleteStation:function(){var e=this;this.$store.dispatch("sysd/deleteStation",this.stationId).then(function(t){e.$message.success(t.msg),e.reload()})}},inject:["reload"],mounted:function(){this.initData()},data:function(){return{tableData:[],currentPage:1,defalut_pageSize:10,dialogFormVisible:!1,dialogFormVisible2:!1,dialogFormVisible3:!1,districts:"",users:"",totalPage:0,stations:[],centerDialogVisible:!1,stationId:"",form:{id:"",name:"",longtitude:"",latitude:"",currLevel:"",preLevel:"",user:"",district:"",province:"",upstreamId:"",downstreamId:""},form1:{id:"",name:"",longtitude:"",latitude:"",currLevel:"",preLevel:"",user:"",district:"",upstreamId:"",downstreamId:"",province:"",isAlert:""},provinces:[{id:8601,name:"北京市"},{id:8602,name:"上海市"},{id:8603,name:"天津市"},{id:8604,name:"重庆市"},{id:8605,name:"河北省"},{id:8606,name:"山西省"},{id:8607,name:"内蒙古自治区"},{id:8608,name:"辽宁省"},{id:8609,name:"吉林省"},{id:8610,name:"黑龙江省"},{id:8611,name:"江苏省"},{id:8612,name:"浙江省"},{id:8613,name:"安徽省"},{id:8614,name:"江西省"},{id:8615,name:"山东省"},{id:8616,name:"河南省"},{id:8617,name:"湖北省"},{id:8618,name:"广西壮族自治区"},{id:8619,name:"四川省"},{id:8620,name:"云南省"},{id:8621,name:"陕西省"},{id:8622,name:"甘肃省"},{id:8623,name:"宁夏回族自治区"},{id:8624,name:"湖南省"},{id:8625,name:"广东省"}],station_title:""}}},d={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"stationManager"},[l("div",{staticStyle:{"margin-bottom":"20px",float:"left"}},[l("el-button",{attrs:{type:"success"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("添加")])],1),e._v(" "),l("div",{staticClass:"block",staticStyle:{float:"right"}},[l("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[5,10,15,20],"page-size":e.defalut_pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalPage},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),l("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[l("el-table-column",{attrs:{fixed:"",prop:"id",label:"站点编号",width:"100",align:"center"}}),e._v(" "),l("el-table-column",{attrs:{prop:"name",label:"站点名称",width:"120",align:"center"}}),e._v(" "),l("el-table-column",{attrs:{prop:"longtitude",label:"经度",width:"120",align:"center"}}),e._v(" "),l("el-table-column",{attrs:{prop:"latitude",label:"纬度",width:"120",align:"center"}}),e._v(" "),l("el-table-column",{attrs:{prop:"currlevel",label:"当前水质等级",width:"100",align:"center"}}),e._v(" "),l("el-table-column",{attrs:{prop:"prelevel",label:"上周水质等级",width:"100",align:"center"}}),e._v(" "),l("el-table-column",{attrs:{label:"站点状态",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("div",{directives:[{name:"show",rawName:"v-show",value:0==t.row.isAlert,expression:"scope.row.isAlert == 0"}]},[e._v("正常")]),e._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:1==t.row.isAlert,expression:"scope.row.isAlert == 1"}]},[e._v("异常")]),e._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:2==t.row.isAlert,expression:"scope.row.isAlert == 2"}]},[e._v("停站")]),e._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:3==t.row.isAlert,expression:"scope.row.isAlert == 3"}]},[e._v("维修")])]}}])}),e._v(" "),l("el-table-column",{attrs:{prop:"responsible",label:"负责人ID",width:"120",align:"center"}}),e._v(" "),l("el-table-column",{attrs:{prop:"userinfo.name",label:"负责人名称",width:"120",align:"center"}}),e._v(" "),l("el-table-column",{attrs:{prop:"district.name",label:"所属流域",width:"200",align:"center"}}),e._v(" "),l("el-table-column",{attrs:{prop:"province.name",label:"所属省市",width:"100",align:"center"}}),e._v(" "),l("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-button",{attrs:{type:"text",size:"small"},on:{click:function(l){return e.showModifyWindow(t.row)}}},[e._v("修改")]),e._v(" "),l("el-button",{attrs:{type:"text",size:"small"},on:{click:function(l){return e.showDeleteWindow(t.row)}}},[e._v("删除")]),e._v(" "),l("el-button",{attrs:{type:"text",size:"small"},on:{click:function(l){return e.showBasin(t.row)}}},[e._v("查看该站点流域结构")])]}}])})],1),e._v(" "),l("el-dialog",{staticStyle:{"margin-left":"200px","margin-top":"-100px"},attrs:{title:"添加",visible:e.dialogFormVisible,modal:!0,"modal-append-to-body":!1,width:"600px"},on:{"update:visible":function(t){e.dialogFormVisible=t},open:e.open}},[l("div",{staticClass:"add_form",staticStyle:{"padding-left":"100px"}},[l("el-form",{ref:"form",staticStyle:{width:"500px"},attrs:{model:e.form,"label-width":"120px","label-position":"left",size:"small"}},[l("el-form-item",{attrs:{label:"站点编号"}},[l("el-input",{staticStyle:{width:"200px"},model:{value:e.form.id,callback:function(t){e.$set(e.form,"id",t)},expression:"form.id"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"站点名称"}},[l("el-input",{staticStyle:{width:"200px"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"站点经度"}},[l("el-input",{staticStyle:{width:"200px"},model:{value:e.form.longtitude,callback:function(t){e.$set(e.form,"longtitude",t)},expression:"form.longtitude"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"站点纬度"}},[l("el-input",{staticStyle:{width:"200px"},model:{value:e.form.latitude,callback:function(t){e.$set(e.form,"latitude",t)},expression:"form.latitude"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"当前水质等级"}},[l("el-input",{staticStyle:{width:"200px"},model:{value:e.form.currLevel,callback:function(t){e.$set(e.form,"currLevel",t)},expression:"form.currLevel"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"上周水质等级"}},[l("el-input",{staticStyle:{width:"200px"},model:{value:e.form.preLevel,callback:function(t){e.$set(e.form,"preLevel",t)},expression:"form.preLevel"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"省市"}},[l("el-select",{attrs:{placeholder:"请选择所属省市"},model:{value:e.form.province,callback:function(t){e.$set(e.form,"province",t)},expression:"form.province"}},[l("el-option",{attrs:{label:"无",value:"null"}}),e._v(" "),e._l(e.provinces,function(e,t){return l("el-option",{key:t,attrs:{label:e.name,value:e.id}})})],2)],1),e._v(" "),l("el-form-item",{attrs:{label:"上游站点"}},[l("el-select",{attrs:{placeholder:"请选择下游站点"},model:{value:e.form.upstreamId,callback:function(t){e.$set(e.form,"upstreamId",t)},expression:"form.upstreamId"}},[l("el-option",{attrs:{label:"无",value:"null"}}),e._v(" "),e._l(e.stations,function(e,t){return l("el-option",{key:t,attrs:{label:e.stationName,value:e.stationId}})})],2)],1),e._v(" "),l("el-form-item",{attrs:{label:"下游站点"}},[l("el-select",{attrs:{placeholder:"请选择下游站点"},model:{value:e.form.downstreamId,callback:function(t){e.$set(e.form,"downstreamId",t)},expression:"form.downstreamId"}},[l("el-option",{attrs:{label:"无",value:"null"}}),e._v(" "),e._l(e.stations,function(e,t){return l("el-option",{key:t,attrs:{label:e.stationName,value:e.stationId}})})],2)],1),e._v(" "),l("el-form-item",{attrs:{label:"负责人"}},[l("el-select",{attrs:{placeholder:"请选择负责人"},model:{value:e.form.user,callback:function(t){e.$set(e.form,"user",t)},expression:"form.user"}},e._l(e.users,function(e,t){return l("el-option",{key:t,attrs:{label:e.name,value:e.uid}})}),1)],1),e._v(" "),l("el-form-item",{attrs:{label:"所属流域 "}},[l("el-select",{attrs:{placeholder:"请选择流域"},model:{value:e.form.district,callback:function(t){e.$set(e.form,"district",t)},expression:"form.district"}},e._l(e.districts,function(e,t){return l("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1)],1)],1)],1),e._v(" "),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("确 定")])],1)]),e._v(" "),l("el-dialog",{staticStyle:{"margin-left":"200px","margin-top":"-100px"},attrs:{title:"修改",visible:e.dialogFormVisible2,modal:!0,"modal-append-to-body":!1,width:"600px"},on:{"update:visible":function(t){e.dialogFormVisible2=t},open:e.open}},[l("div",{staticClass:"modify_form",staticStyle:{"padding-left":"100px"}},[l("el-form",{ref:"form1",staticStyle:{width:"350px"},attrs:{model:e.form1,"label-width":"120px","label-position":"left",size:"small"}},[l("el-form-item",{attrs:{label:"站点编号"}},[l("el-input",{staticStyle:{width:"200px"},attrs:{disabled:""},model:{value:e.form1.id,callback:function(t){e.$set(e.form1,"id",t)},expression:"form1.id"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"站点名称"}},[l("el-input",{staticStyle:{width:"200px"},model:{value:e.form1.name,callback:function(t){e.$set(e.form1,"name",t)},expression:"form1.name"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"站点经度"}},[l("el-input",{staticStyle:{width:"200px"},model:{value:e.form1.longtitude,callback:function(t){e.$set(e.form1,"longtitude",t)},expression:"form1.longtitude"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"站点纬度"}},[l("el-input",{staticStyle:{width:"200px"},model:{value:e.form1.latitude,callback:function(t){e.$set(e.form1,"latitude",t)},expression:"form1.latitude"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"当前水质等级"}},[l("el-input",{staticStyle:{width:"200px"},model:{value:e.form1.currLevel,callback:function(t){e.$set(e.form1,"currLevel",t)},expression:"form1.currLevel"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"上周水质等级"}},[l("el-input",{staticStyle:{width:"200px"},model:{value:e.form1.preLevel,callback:function(t){e.$set(e.form1,"preLevel",t)},expression:"form1.preLevel"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"站点状态"}},[l("el-input",{staticStyle:{width:"200px"},model:{value:e.form1.isAlert,callback:function(t){e.$set(e.form1,"isAlert",t)},expression:"form1.isAlert"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"省市"}},[l("el-select",{attrs:{placeholder:"请选择所属省市"},model:{value:e.form1.province,callback:function(t){e.$set(e.form1,"province",t)},expression:"form1.province"}},[l("el-option",{attrs:{label:"无",value:"null"}}),e._v(" "),e._l(e.provinces,function(e,t){return l("el-option",{key:t,attrs:{label:e.name,value:e.id}})})],2)],1),e._v(" "),l("el-form-item",{attrs:{label:"负责人"}},[l("el-select",{attrs:{placeholder:"请选择负责人"},model:{value:e.form1.user,callback:function(t){e.$set(e.form1,"user",t)},expression:"form1.user"}},e._l(e.users,function(e,t){return l("el-option",{key:t,attrs:{label:e.name,value:e.uid}})}),1)],1),e._v(" "),l("el-form-item",{attrs:{label:"所属区域 "}},[l("el-select",{attrs:{placeholder:"请选择所属区域"},model:{value:e.form1.district,callback:function(t){e.$set(e.form1,"district",t)},expression:"form1.district"}},e._l(e.districts,function(e,t){return l("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1)],1)],1)],1),e._v(" "),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:e.modify}},[e._v("确 定")])],1)]),e._v(" "),l("el-dialog",{staticStyle:{"margin-top":"20px"},attrs:{title:"提示",visible:e.centerDialogVisible,width:"30%",center:"","modal-append-to-body":!1},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[l("span",[e._v("该操作会删除位于该站点的设备信息和此设备具有的数据，确定删除吗？")]),e._v(" "),l("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.centerDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:e.deleteStation}},[e._v("确 定")])],1)]),e._v(" "),l("el-dialog",{staticStyle:{"margin-left":"200px","margin-top":"-100px"},attrs:{title:e.station_title,visible:e.dialogFormVisible3,modal:!0,"modal-append-to-body":!1,width:"600px"},on:{"update:visible":function(t){e.dialogFormVisible3=t},open:e.open}},[l("div",{staticStyle:{height:"500px",width:"500px"},attrs:{id:"chartArea"}})])],1)},staticRenderFns:[]};var c=l("VU/8")(n,d,!1,function(e){l("OeSr")},null,null);t.default=c.exports}});
//# sourceMappingURL=8.48270f76b3f50f1dc8b6.js.map