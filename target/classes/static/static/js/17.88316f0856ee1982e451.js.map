{"version":3,"sources":["webpack:///src/components/kg/index.vue","webpack:///./src/components/kg/index.vue?cfcc","webpack:///./src/components/kg/index.vue"],"names":["echarts","__webpack_require__","kg","data","entityName","option","form","entityFrom","startLabel","relation","entityTo","endLabel","nodes","relationships","mounted","this","initData","inject","methods","ellipsis","sentence","length","substring","_this","temp","split","infos","entityId","$store","dispatch","then","response","_ref","obj","nodesList","set_default","a","i","node_name1","eliminateEli","entity","node_name2","entityAmbiguous","value","valueId","valueAmbiguous","add","nodesConfig","forEach","e","tmp","name","symbolSize","itemStyle","normal","color","generate_color","show","push","links","_i","source","target","tooltip","formatter","x","animationDurationUpdate","animationEasingUpdate","series","type","layout","roam","label","edgeSymbol","edgeSymbolSize","edgeLabel","textStyle","fontSize","force","repulsion","edgeLength","draggable","lineStyle","width","curveness","defineProperty_default","showKg","replace","_this2","status","$message","message","msg","reload","getInfo","params","generate_random_color","r","generate_fix_random","g","b","toString","test","n","m","Math","floor","random","_this3","kgShow","document","getElementById","myChart","init","setOption","_model","on","chartParam","dataIndex","console","log","components_kg","render","_vm","_h","$createElement","_c","_self","staticClass","staticStyle","text-align","margin-bottom","padding-top","attrs","placeholder","model","callback","$$v","expression","_v","icon","click","height","id","staticRenderFns","Component","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/17.88316f0856ee1982e451.js","sourcesContent":["<template>\n  <div class=\"kgContainer\">\n    <!--<div class=\"alert alert-info\" role=\"alert\" style=\"margin-bottom: 20px;\">\n      <h1>The Knowledge Graph Of Water Quality</h1>\n      <font size=\"4\"><font size=\"5\"><strong>Prompt:</strong></font>添加关系格式如:张三-爱慕->李四</font>\n      \n    </div>-->\n    <div class=\"search\" style=\"text-align: center;margin-bottom: 10px;padding-top: 32px; \">\n      <el-input v-model=\"entityName\" placeholder=\"请输入内容\" style=\"width: 400px;\"></el-input>\n      <el-button type=\"primary\" icon=\"el-icon-search\" @click=\"initData\">搜索</el-button>\n    </div>\n    <!--<div class=\"add\" style=\"text-align: center;margin-bottom: 30px;\">\n      初始节点：   <el-input v-model=\"form.entityFrom\" placeholder=\"请输入内容\" style=\"width: 100px;\"></el-input>\n      <el-select v-model=\"form.startLabel\" placeholder=\"请选择开始节点类型\">\n        <el-option label=\"站点\" value=\"Station\">\n        </el-option>\n        <el-option label=\"区域\" value=\"District\">\n        </el-option>\n        <el-option label=\"常识\" value=\"Knowledge\">\n        </el-option>\n      </el-select>\n      关系：<el-input v-model=\"form.relation\" placeholder=\"请输入内容\" style=\"width: 100px;\"></el-input>\n      终止节点：<el-input v-model=\"form.entityTo\" placeholder=\"请输入内容\" style=\"width: 100px;\"></el-input>\n      <el-select v-model=\"form.endLabel\" placeholder=\"请选择终止节点类型\">\n        <el-option label=\"站点\" value=\"Station\">\n        </el-option>\n        <el-option label=\"区域\" value=\"District\">\n        </el-option>\n        <el-option label=\"常识\" value=\"Knowledge\">\n        </el-option>\n      </el-select>\n      <el-button type=\"primary\" icon=\"el-icon-search\" @click=\"add\">添加</el-button>\n    </div>-->\n    <div class=\"kgShow\" id=\"kgShow\" style=\"width: 100%;height: 800px;\">\n\n    </div>\n\n    <!--<div class=\"test\" id=\"tst\" style=\"width: 100%;height: 500px;\"></div>-->\n  </div>\n</template>\n\n<script>\n  var echarts = require('echarts');\n  export default {\n    data() {\n      return {\n        entityName: '',\n        option: '',\n        form: {\n          entityFrom: '',\n          startLabel: '',\n          relation: '',\n          entityTo: '',\n          endLabel: ''\n        },\n        nodes: [],\n        relationships: [],\n\n      }\n    },\n    mounted() {\n      this.initData()\n      //    this.tst()\n    },\n    inject: ['reload'],\n    methods: {\n      ellipsis(sentence){\n        if(sentence.length > 10){\n          sentence = sentence.substring(0,10)+\"...\"\n        }\n        return sentence\n      },\n      initData() {\n        const temp = this.entityName.split('@')\n        const infos = {\n          'entityName':temp[0],\n          'entityId': temp[1]\n        }\n        \n        this.$store.dispatch('kg/search2', infos).then(response => {\n          const data = response.obj\n          //        const nodes = response.nodes\n          //        const relationship = response.relationships\n          //        const nodesList = []\n          const nodesList = new Set()\n          for(let i = 0; i < data.length; i++) {\n            const node_name1 = this.eliminateEli(data[i].entity) + '@' + data[i].entityId\n            const entityAmbiguous = this.eliminateEli(data[i].entityAmbiguous)\n            const node_name2 = this.eliminateEli(data[i].value) + '@' + data[i].valueId\n            const valueAmbiguous = this.eliminateEli(data[i].valueAmbiguous)\n            nodesList.add(node_name1)\n            nodesList.add(node_name2,valueAmbiguous)\n          }\n          \n          \n          const nodesConfig = []\n          nodesList.forEach((e, i) => {\n//          alert(JSON.stringify(e))\n            const tmp = {\n              name: e,\n//            ambiguous: e[1],\n              symbolSize: 50,\n              itemStyle: {\n                normal: {\n                  color: this.generate_color(),\n                  show: true,\n                }\n              }\n            }\n            nodesConfig.push(tmp)\n          })\n\n          const links = []\n          for(let i = 0; i < data.length; i++) {\n            const tmp = {\n              source: this.eliminateEli(data[i].entity)+'@'+data[i].entityId,\n              target: this.eliminateEli(data[i].value)+'@'+data[i].valueId,\n              name: this.eliminateEli(data[i].relation)\n            }\n            links.push(tmp)\n          }\n\n          const option = {\n            //          title: {\n            //            text: '水质知识图谱',\n            //            textStyle: {\n            //              color: '#fff'\n            //            }\n            //          },\n            //设置鼠标移动到节点处显示的信息\n            tooltip: {\n              formatter: function(x) {\n                return x.data.name;\n              }\n            },\n            animationDurationUpdate: 1500,\n            animationEasingUpdate: 'quinticInOut',\n            series: [{\n              type: 'graph',\n              layout: 'circular',\n//            layout: 'force',\n              symbolSize: 80,\n              roam: true,\n              label: {\n                normal: {\n                  show: true,\n                  color: 'black'\n                }\n              },\n              edgeSymbol: ['circle', 'arrow'],\n              edgeSymbolSize: [4, 10],\n              edgeLabel: {\n                normal: {\n                  textStyle: {\n                    //                  color: '#fff',  \n                    fontSize: 20\n                  }\n                }\n              },\n              force: {\n                repulsion: 3000, //斥力\n                edgeLength: [20, 80] //默认距离\n              },\n              //            layout:'circular',\n              draggable: true,\n              lineStyle: {\n                normal: {\n                  width: 2,\n                  color: 'black',\n                  curveness: 0.2,\n                  length: 20\n                }\n              },\n              edgeLabel: {\n                normal: {\n                  show: true,\n                  formatter: function(x) {\n                    return x.data.name;\n                  }\n                }\n              },\n              data: nodesConfig,\n              links: links\n            }]\n          }\n          this.option = option\n\n          this.showKg()\n        })\n      },\n      eliminateEli(x) {\n        //      alert(x)\n        x = x.replace(/\\\"/g, '')\n        return x\n      },\n      add() {\n        this.$store.dispatch('kg/save', this.form).then(response => {\n          if(response.status == 200) {\n            this.$message({\n              message: response.msg,\n              type: 'success'\n            })\n\n            this.reload()\n          }\n        })\n      },\n      getInfo(params) {},\n      generate_random_color() {\n        let r = this.generate_fix_random(50, 200)\n        let g = this.generate_fix_random(50, 200)\n        let b = this.generate_fix_random(50, 200)\n        let color = r.toString(16) + g.toString(16) + b.toString(16)\n\n        return color\n      },\n      generate_color() {\n        let regx = /[^FEfe]/\n        let color = this.generate_random_color()\n        if(regx.test(color)) {\n          color = this.generate_random_color()\n        }\n        return '#' + color\n      },\n      generate_fix_random(n, m) {\n        let x = Math.floor(Math.random() * (m - n + 1)) + n\n        return x\n      },\n      showKg() {\n        const kgShow = document.getElementById('kgShow')\n        const myChart = echarts.init(kgShow, 'light')\n        myChart.setOption(this.option)\n\n        let data = myChart._model.option.series[0].data;\n        myChart.on(\"click\", (chartParam) => {\n          //        console.log(myChart._model)\n//                  console.log(chartParam)\n          const temp = data[chartParam.dataIndex].name\n//        const entityName = temp[0]\n          this.entityName = temp\n          this.initData()\n        });\n\n        myChart.on(\"mouseover\", (chartParam) => {\n          console.log(chartParam)\n        })\n      }\n    }\n  }\n</script>\n\n<style scoped>\n  .kgContainer {\n    width: 100%;\n    /*0b2838*/\n    background-color: #fff;\n    /*padding: 32px;*/\n  }\n  \n  .kgShow {\n    width: 100%;\n    height: 500px;\n    /*background-color: #0b2838;*/\n  }\n</style>\n\n\n// WEBPACK FOOTER //\n// src/components/kg/index.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"kgContainer\"},[_c('div',{staticClass:\"search\",staticStyle:{\"text-align\":\"center\",\"margin-bottom\":\"10px\",\"padding-top\":\"32px\"}},[_c('el-input',{staticStyle:{\"width\":\"400px\"},attrs:{\"placeholder\":\"请输入内容\"},model:{value:(_vm.entityName),callback:function ($$v) {_vm.entityName=$$v},expression:\"entityName\"}}),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\",\"icon\":\"el-icon-search\"},on:{\"click\":_vm.initData}},[_vm._v(\"搜索\")])],1),_vm._v(\" \"),_c('div',{staticClass:\"kgShow\",staticStyle:{\"width\":\"100%\",\"height\":\"800px\"},attrs:{\"id\":\"kgShow\"}})])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-324858d4\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/kg/index.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-324858d4\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./index.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./index.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./index.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-324858d4\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./index.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-324858d4\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/kg/index.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}